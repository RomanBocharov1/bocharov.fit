<html>

<head>
<meta charset="utf-8">
</head>
SQL <br>
<br>
Используем mysql workbench - можно импортировать файл БД(иконка сохранить, иконка открыть базу.sql) , либо подключиться в серверу, где уже есть БД<br>
workbench хранит базу, куда мы ее сохраним, либо сохраняет на серваке<br>
<br>
mysql (субд) - работает клиент-сервер, поэтому нужен sql клиент-сервер<br>
sqlite (субд) - встраиваемая БД , не нужен сервер, все сохраняется в одном файле на клиенте <br>
<br>
SQL реляционные - бд нужно для хранения данных и связей между ними ,имеют четкую структуру и всегда связаны между собой, <br>
пара ключ-значение:по ключу сохраняем данные, по ключу получаем данные <br>
nosql - содержат документы, иерархические структуры данных (json формат)<br>
<br>
Типы данных: <br>
INT - целые числа<br>
DEC - десятичные числа<br>
blob/text/memo - большой обьем текстовой информации (изображение и компилированный программный код,большой обьем текста, текст больше 255 символов )<br>
char/varchar - строки, текст до 255 символов  (строка фиксированного размера, строка нефиксированного размера)<br>
date/time/year - форматы даты <br>
float/double - данные с плавающей точкой (десятичная точка может поддерживать переменное количество цифр до и после себя)<br>
boolean - тру\фолс<br>
timestamp - нужен, чтобы отметить время создания элемента в БД<br>
null - пустое значение<br>
<br>
<br>
<br>
Кратко о командах:<br>
show: бд, таблицы, columns<br>
create: бд, таблицу<br>
drop: бд, таблицу <br>
use: бд   <br>
TRUNCATE table .... удалить все данные из таблицы<br>
alter table Persons add Birthday DATE; Добавьте столбец типа DATE с названием Birthday.<br>
insert into: вставить (поля) values (записи)   <br>
select: все, поле<br>
distinct: уникальное  <br>
where: условие  <br>
limit 2: ограничение по количеству   <br>
order by: в порядке от 1 к последнему<br>
desc: с последнего до первого <br>
as: псевдоним   <br>
alter table (add, drop: добавить поле , выбросить поле) add age int after id; add age int first;<br>
update ... set... where(изменить таблицу,поставить в поле = запись где id... )  <br> 
update teacher set age = 20 where id = 1;   <br> 
like  "%...."  (пишем без =) ,  not like "a%" (не начинается с буквы а)  select name from Passenger where name like "%man"; <br>
LIKE '_a%'(2 -ая буква а)<br>
LIKE '[acs]%'; (первая буква или а или c или s)<br>
LIKE '[a-f]%'; (первая буква начинается с a до f)<br>
LIKE '[^acf]%';(первая буква ни а ни c ни s)<br>
больше меньше = <br>
not: наоборот <br>
beetwen: между значениями (слова буду в алфавитном порядке)  <br>
in: условие, поле, выбрать несколько значений (....,....): SELECT * FROM Customers WHERE Country IN ('Norway','France'); <br>
union: соединить таблицы без повторов<br>
union all: соединить таблицы полностью<br>
avg(age)  <br>
max(age)   <br>
min(age)  <br>
sum(age)   <br>
count(age): посчитать количество записей(отобразится от максимального кол-ва к минимальному<br>
<br>
GROUP BY: SELECT age, SUM(salary) FROM workers GROUP BY age(группирует без повторов,складывает<br>
в сумму и выводит на основании выбранного поля)<br>
возраст    сумма<br>
23          500<br>
24          1000<br>
25          700<br>
<br>
create table teacher(    <br> 
id int auto_increment primary key,   <br>                                                
surname varchar(255) not null, <br>
.........,<br>
.........,  <br>          
);
<br>
create table lessons( <br>
id int auto_increment primary key,  <br>                                                 
name varchar(255) not null,<br>
.........,              <br>  
teacher_id int not null,      <br>             
foreign key (teacher_id) reference teacher (id) <br>
.........,<br>
.........,<br>
);<br>
<br>
выбрать таблица.поле, таблица.поле  из 1 таблицы джойн  2 таблица на основании таблица.ключ = таблица.ключ<br>
условие ....<br>
если есть напротив ключа запись в выбранном поле (в начале скрипта), то оно выбирается и присоединяется<br>
select teacher.surname, lesson.name from teacher inner join       <br>
lesson on teacher.id = lesson_teacher.id; <br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
CRUD-операции: Create, Read, Update, Delete. Основные методы работы с базами данных. <br>
<br>
индекс (анг. указатель)  нужны для быстрого поиска в больших массивах данных.(маленьких тоже)<br>
index файлы используются только с индексированным содержимым.<br>
индексный файл это оглавление, где лежат данные и как перейти в опред категорию в SQL индексы хранятся в виде b-tree<br>
<br>
акроним ACID описывает требования к транзакционной системе (например, к СУБД), обеспечивающие наиболее надёжную и предсказуемую её работу.<br>
<br>
когда есть связь многие ко многим , то создается 3 таблицы : 1 - сущность и его id  2 - вторая сущность и его id 3 - связь 1 id  и 2 id <br>
<br>
SQl (structured query language) - язык структуироваанх запросов в БД,<br>
основной интерфейс работы с реляционными БД<br>
Реляционная БД - когда таблицы связаны друг с другом по ключу<br>
Информация хранится на сервере в виде таблиц(столбцов и строчек) <br>
(столбцы id книги,имя автора, название книги, число страниц и т д)<br>
Пример использования: <br>
- Можно залогинеться через базу данных(если не знаем логин и пароль)<br>
- Создать новые тестовые данные в виде юзера, если в БД нет ни одного<br>
- Можно дать себе права админа через БД<br>
- Можно посмотреть работает ли функция создания группы(например), баг это функции или графический баг<br>
- Можно залить для тестов множестов юзеров в БД, чтобы не делать это на фронте.<br>
Primary Key(первичный ключ) - столбец в таблице, который содержит уникальное значение, <br>
для идентификации строки талицы(ID)<br>
Foreign Key(внешний ключ) - устанавливается для столбцов зависимой таблицы и указывает<br>
 на 1 столбец из главной таблицы.указывает на первичный ключ.<br>
<hr>
NOSQL - БД ( например программа MongoDB)<br>
Информация храниться в виде документов json<br>
{} - обьект  [] - массив данных<br>
В документе в качестве столбцов(как в sql БД) служат атрибуты обьекта<br>
(id книги,имя автора, название книги, число страниц и т д)<br>
<br>
Иньекции sql - это атака на базу данных, которая позволит выполнить некоторое действие,<br>
которое не планировалось создателем скрипта.<br>
Инъекция появляется из входящих данных, которые не фильтруются <br>
Вариант:<br>
ДОСТАНЬ ИЗ кошелька 100 РУБЛЕЙ И ДАЙ ИХ Васе<br>
ДОСТАНЬ ИЗ кошелька 100 РУБЛЕЙ И ДАЙ ИХ Васе ИЛИ Пете<br>
<br>
null не может быть равен чему-то и не может быть больше или меньше чего-то, нул есть нул <br>
если в селекте строчный символ, то нам вернет только значения со строчными символами(а%)<br>
union all соединит все строки в 2 таблицах, даже если есть повторы <br>
union не будет добавлять строку, если есть повтор ( также уберет дубли в рамках одного набора данных(1 таблицы))<br>
alias - псевдоним с англ<br>
where - накладывает условия на весь набор данных<br>
having - фильтровка по сгрупированной информации ( после group by)<br>
джойны: inner join, right join, left join, cross join, full join<br>
dml (date manipulation language) - манипуляции с данными(select insert update delete )<br>
первое действие делается в скобках<br>
null  - значит неизвестно, т.е. если есть нул в таблице, то запрос выведит пустоту, т.к. <br>
неизвестно какое значение находится в нул(нужно прописать условие  where id is not null)<br>
connect by -  соединять с самой собой <br>
connect by level - соединять с самой собой, пока уровень соединения не будет .....<br>
lenght - показывает сколько букв в слове<br>
строки после условия (where) берутся в одинарные кавычки ''<br>
разница union и джойн: создается общее поле из 2 полей из 2 таблиц, <br>
создаются 2 поля из 2 связанных по id наборов(напротив друг друга) записей из 2 таблиц + <br>
джойн это 1 запрос, юнион может бчть 2 и более запроса <br>
<br>
ПРИМЕРЫ:<br>
Найдите номер модели, скорость и размер жесткого диска для всех ПК стоимостью <br>
менее 500 дол. Вывести: model, speed и hd<br>
select model, speed, hd from PC where price < 500;<br>
<br>
Найдите уникальных производителей принтеров. Вывести: maker<br>
Select distinct maker from product where type = 'Printer';<br>
<br>
Найдите номер модели, объем памяти и размеры экранов ПК-блокнотов, цена которых превышает 1000 дол.<br>
Select model, ram, screen from Laptop where price > 1000;<br>
<br>
Найдите все записи таблицы Printer для цветных принтеров.<br>
Select * from printer where color = 'y';<br>
<br>
select * from table order by country, city; (сортировка по стране, потом по городу)<br>
<br>
INSERT INTO Customers (CustomerName, Address, City, PostalCode,Country)   вставить в таблицу ... (поля) values (записи)<br>
VALUES('Hekkan Burger','Gateveien 15','Sandnes','4306','Norway');<br>
<br>
SELECT * FROM Customers WHERE поле is not null;<br>

Выведите нагруженность (число пассажиров) каждого рейса (trip). 
Результат вывести в отсортированном виде по убыванию нагруженности. 
select trip,count(passenger) as count from Pass_in_trip 
group by Trip
order by count DESC;
если даем псевдоним , то в скрипте используем уже данное название


Во сколько Стив Мартин (Steve Martin) прилетел в Лондон (London)
select time_in from Trip where town_to = 'London' and id in
(select trip from Pass_in_trip where passenger in
(select id from Passenger where name = 'Steve Martin'));




<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
СКРИПТЫ:  (после каждого скрипта ставиться ; )<br>
Оригинал                                         Перевод <br>
show databases;                                показать все БД<br>
create database НАЗВАНИЕ;                      создать БД такую-то<br>
drop database НАЗВАНИЕ;                        выбросить БД  такую-то<br>
use  НАЗВАНИЕ;                               использовать такую-то бд<br>
show tables;                                 показать все таблицы<br>
<br>
<br>
<br>
<br>
<br>
create table teacher(                      создать таблицу такую-то,создаем колонки:<br>
id int auto_increment primary key,         уникальный идентификатор(должен быть в каждой таблице), значение числовое, <br>
                                           каждая следующая запись будет на единицу больше, это первичный ключ <br>
surname varchar(255) not null,             название столбца, строковое значение(кол-во символов), не может быть пустым <br>
);<br>
<br>
<br>
<br>
<br>
<br>
<br>
create table lessons(                      создать таблицу такую-то,создаем колонки:<br>
id int auto_increment primary key,         уникальный идентификатор(должен быть в каждой таблице), значение числовое, <br>
                                           каждая следующая запись будет на единицу больше, это первичный ключ <br>
name varchar(255) not null,                название столбца, строковое значение(кол-во символов), не может быть пустым <br>
teacher_id int not null,                   название столбца, числовое значение,не может быть пустым <br>
foreign key (teacher_id) reference teacher (id)   внешний ключ(указываем какое поле будет им), <br>
                                                  делаем ссылку на другую таблицу с которой внешний ключ будет связан  <br>     
);<br>
<br>
<br>
<br>
<br>
<br>
<br>

show columns from teacher;                                показать все колонки из такой-то таблицы<br>
insert into teacher (surname) values ("Иванов");                 вставить в такую-то таблицу(название поля) значение (запись такая-то)  <br>
insert into lessons (name, teacher_id) values ("Математика",1), ("Русский",2);   вставить в такую-то таблицу(название поля\полей) <br>
                                                                                  значение (запись такая-то/записи такие-то) <br>
                                                                                  <br>
                                                                                  <br>
                                                                                  <br>
                                                                                  <br>
                                                                                  <br>
select * from teacher;                     выбрать все(* это все поля) из такой-то таблицы (вместо звездочки могут быть названия полей)<br>
select id from teacher;                    выбрать такое-то поле из такой -то таблицы <br>
select id, surname from teacher;           через запятую указываются поля, которые нужно выбрать из таблицы <br>
select dictinct surname from teacher;      выбрать уникальное из такого-то поля из такой такой-то таблицы <br>
select * from teacher where id = 1;        выбрать все из такой-то таблицы, условие такое - то (id = или > 1 или меньше 1)<br>
select * from teacher where surname = "Петров";      выбрать все из такой-то таблицы, условие: выбрать такое-то поле и такие-то записи <br>
                                                     из него(значение строчного поля помещается в кавычки)<br>
select * from teacher where surname = "Петров" limit 2;  выбрать все из такой-то таблицы, условие: выбрать такое-то поле и <br>
                                                        такие-то записи,ограничение 2 записи<br>
select * from teacher limit 5;                          выбрать все из такой-то таблицы, ограничение 5 записей <br>
<br>
<br>
<br>
<br>
<br>
<br>
select id as "Идентификатор", surname as "Идентификатор" from teacher;        выбрать поле такое-то и заменить его имя на...,<br>
                                                                              выбрать поле такое-то и заменить его имя на... из такой -то таблицы<br>
                                                                              <br>
                                                                              <br>
                                                                              <br>
                                                                              <br>
                                                                              <br>
select * from teacher order by surname;                      выбрать все из такой-то таблицы, отсортировать по такому-то полю(текстовые поля сортирует по алфавиту)<br>
select * from teacher order by id;                           id будет отсортировано от 1 до последнего, сверху вниз<br>
select * from teacher order by id desc;                      выбрать все из такой-то таблицы, отсортировать по такому-то полю,от последнего к первому<br>
<br>
<br>
<br>
<br>
alter table teacher add age int;           изменить таблицу такую-то, добавить такое-то поле, числовое или текстовое значение будет в этом поле<br>
alter table teacher add age int after id;  изменить таблицу такую-то, добавить такое-то поле, числовое или текстовое значение будет в этом поле, после поля такого-то<br>
alter table teacher add age int first;     изменить таблицу такую-то, добавить такое-то поле, числовое или текстовое значение будет в этом поле, поставить первым(вторым и т д)<br>
alter table teacher drop age;              изменить таблицу такую-то,ds,выбросить поле такое-то (возможно нужно указать column до поля)<br>
update teacher set age = 20 where id = 1;  изменить такую-то таблицу , поставить в такое-то поле такую-то запись где напротив в этой таблице <br>
                                           такое-то поле и такая-то запись<br>
update teacher set age = 20;               изменить такую-то таблицу , поставить в такое-то поле такую-то запись(заполняется все поле)<br>
<br>
<br>
<br>
<br>
<br>
select * from teacher where surname like "%ов";        выбрать все из такой-то таблицы , условие: поле такое-то: записи похожи на такое-то<br>
                                                       (все поля , которые заканчиваются на ОВ)<br>
                                         "п%ов"        (все поля , которые  начинаются на П и заканчиваются на ОВ)<br>
                                         <br>
                                         <br>
                                         <br>
                                         <br>
                                         <br>
select * from teacher where id > 3 and age > 45;       выбрать все из такой-то таблицы , условие: id > 3 и age > 45   <br>                           
select * from teacher where id > 3 or age > 45;        выбрать все из такой-то таблицы , условие: id > 3 или age > 45 <br>
select * from teacher where not id > 3;                условие наоборот<br>
select * from teacher where age between 35 and 45;     выбрать все из такой-то таблицы , условие: поле такое-то , значение записей между 35 и 45 <br>
<br>
<br>
<br>
<br>
delete from teacher;                                   удалить из такой-то таблицы(удалятся все записи)<br>
delete from teacher where id = 5;                      удалить из такой-то таблицы,условие: поле такое-то , запись такая-то<br>
<br>
<br>
<br>
<br>
SELECT * FROM customers WHERE id IN(1, 4, 6);     выбрать все из такой-то таблицы, условие,такое -то поле выбрать несколько значений (текст в '')<br>
<br>
<br>
<br>
<br>
ПОДЗАПРОС:(сначала выполняется подзапрос в скобках, потом выполняется запрос и использует результат подзапроса)<br>
select firstname, surname, id from customers where age in (select age from customers where id > 1 and age > 21);<br>
Выбрать такие -то поля из такой -то таблицы, условие, такое -то поле: выбрать несколько значений<br>
(выбрать такое-то поле из такой-то таблицы , условие id > 1 and age > 21)<br>
<br>
INSERT INTO customers_1<br>
select * from customers_2 where id in (select id from customers_2)<br>
вставить в такую-то таблицу <br>
выбрать все из такой-то таблицы , условие, такое-то поле, выбрать определенные значения<br>
(выбрать такое-то поле из такой -то таблицы)<br>
INSERT использует результат, полученный из подзапроса, для вставки в другую таблицу.<br>
<br>
update customers_1 set salary = salary * 0.25 where age in(select age from customers_2 where age >27)<br>
изменить такую-то таблицу, поставить в такое -то поле такие -то записи, где напротив этих записей такое-то поле, выбрать определенные значения<br>
(выбрать такое-то поле из такой-то таблицы, условие, такое-то поле > 27)<br>
выбираются записи из 2 таблицы и записи из 1 таблицы, которые напротив них будут изменены<br>
одно или несколько полей будет обновлено на основании результата подзапроса<br>
зарплата умножается на 0.25<br>
<br>
delete from customers_1 where age in (select from customers_2 where age > 27)<br>
удалить из такой-то таблицы, условие, такое-то поле , выбрать несколько значений<br>
(выбрать из такой-то таблицы, условие, такое -то поле > 27 )<br>
удалится результат подзапроса: выберутся записи из 2 таблицы и удалятся из 1 таблицы <br>
<br>
пишем сначала подзапрос, потом запрос????<br>
<br>
<br>
<br>
<br>
ДЖОЙНЫ: есть 2 таблицы: учителя(левая) и уроки(правая)  (левая таблица идет первой в скрипте, правая второй)<br>
inner join - в новую таблицу попадут только учителя, у которых есть уроки(только связанные записи)<br>
left outer join - в новую таблицу попадут все записи из левой таблицы и только уроки из правой , связанные с учителями из левой<br>
right outer join - в новую таблицу попадут все уроки из правой таблцы и только те учителя из левой таблицы, которые связаны с уроками<br>
full join - в новой таблице будет все записи <br>
select teacher.surname, lesson.name from teacher inner join        выбрать такую-то таблицу.такое-то поле,такую-то таблицу.такое-то поле <br>
lesson on teacher.id = lesson_teacher.id;                          сделать у такой-то таблицы внутреннюю связку с такой-то таблицей основываясь на <br>
                                                                   такая-то таблица.такое-то поле = такая-то таблица.такое-то поле<br>
select teacher.surname, lesson.name from teacher left outer join   все учителя будут в новой таблице  <br>
lesson on teacher.id = lesson_teacher.id; <br>
select teacher.surname, lesson.name from teacher right outer join   все уроки будут в новой таблице  <br>
lesson on teacher.id = lesson_teacher.id; <br>
<br>
<br>
<br>
<br>
<br>
<br>
select * from teacher union select * from lessons;             выбрать все из такой-то таблицы, обьединить, выбрать все из такой-то таблицы<br>
                      (все записи из 2 таблиц будут в 1 таблице, вертикальное обьединение, через union можно перечислять таблицы бесконечно)<br>
                      <br>
                      <br>
                      <br>
                      <br>
                      <br>
select avg(age) from teacher;          выбрать среднее значение(такое-то поле) из такой-то таблицы <br>
select max(age) from teacher;          выбрать максимальное значение(такое-то поле) из такой-то таблицы <br>
select min(age) from teacher;          выбрать минимальное значение(такое-то поле) из такой-то таблицы <br>
select min(age), max(age) from teacher;                 можно несколько сразу <br>
select sum(age) from teacher;          выбрать сумму значений(такое-то поле) из такой-то таблицы<br>
select count(age) from teacher;        выбрать подсчет количества записей (такое-то поле) из такой-то таблицы<br>
select age, count (age) from teacher group by age;      выбрать такое-то поле, выбрать подсчет записей(такое-то поле)<br>
                                                       из такой-то таблицы,сгруппировать такое-то поле<br>
                                                       <br>
                                                       <br>
                                                       <br>
                                                       <br>
                                                       <br>
</body>









</html>